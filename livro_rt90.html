<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Livro RT 90 - ROTAM</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      color: #000;
      padding: 25px;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
    }

    .header img {
      width: 100px;
      display: block;
      margin: 0 auto;
    }

    .header p {
      line-height: 1.4;
      margin: 5px 0;
    }

    h2 {
      text-align: center;
      color: #000;
      margin-top: 10px;
    }

    form {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      margin-top: 20px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
    }

    textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
      font-size: 14px;
    }

    .footer {
      margin-top: 25px;
      text-align: center;
      font-style: italic;
      color: #444;
    }

    button {
      margin-top: 20px;
      background: #198754;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 15px;
      transition: background 0.3s;
    }

    button:hover {
      background: #157347;
    }

    .btn-voltar {
      background: #2c2c2c;
      color: #fff;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .btn-voltar:hover {
      background: #444;
    }

    @media (max-width: 768px) {
      body {
        padding: 15px;
      }

      .header img {
        width: 80px;
      }

      form {
        padding: 15px;
      }
    }
  </style>
</head>
<body>

  <button class="btn-voltar" onclick="voltarPainel()">‚¨Ö Voltar ao Painel</button>

  <div class="header">
    <img src="logo-rotam.png" alt="Logo ROTAM">
    <p><strong>Pol√≠cia Militar do Estado de Mato Grosso</strong></p>
    <p>Comando de Policiamento Especializado<br>Batalh√£o ROTAM</p>
    <p><strong>Relat√≥rio de Servi√ßo do Dia:</strong> <span id="dataAtual"></span></p>
  </div>

  <h2>üìò Livro RT 90</h2>

  <form id="livroForm">
    <label>1Ô∏è‚É£ ROTAM Comando e ROTAM 90:</label>
    <textarea rows="3" id="rotamComando"></textarea>

    <label>2Ô∏è‚É£ Altera√ß√µes na Escala de Servi√ßo:</label>
    <textarea rows="3" id="alteracoesEscala"></textarea>

    <label>3Ô∏è‚É£ Distribui√ß√£o das Equipes:</label>
    <textarea rows="3" id="distribuicaoEquipes"></textarea>

    <label>4Ô∏è‚É£ Ocorr√™ncias Registradas:</label>
    <textarea rows="3" id="ocorrencias"></textarea>

    <label>5Ô∏è‚É£ Justi√ßa e Disciplina:</label>
    <textarea rows="3" id="justicaDisciplina"></textarea>

    <label>6Ô∏è‚É£ Documentos:</label>
    <textarea rows="3" id="documentos"></textarea>

    <label>7Ô∏è‚É£ Diversos:</label>
    <textarea rows="3" id="diversos"></textarea>

    <div class="footer">
      Quartel do Batalh√£o ROTAM ‚Äî Cuiab√°/MT<br>
      Data: <span id="dataRodape"></span>
    </div>

    <button type="button" onclick="gerarPDF()">üìÑ Gerar PDF</button>
  </form>

  <script>
    // === Preenche a data automaticamente ===
    const data = new Date();
    const opcoes = { day: '2-digit', month: '2-digit', year: 'numeric' };
    const dataFormatada = data.toLocaleDateString('pt-BR', opcoes);
    document.getElementById("dataAtual").innerText = dataFormatada;
    document.getElementById("dataRodape").innerText = dataFormatada;

    // === Fun√ß√£o para voltar ao painel ===
    function voltarPainel() {
      window.location.href = "index.html";
    }

    // === Gera√ß√£o do PDF ===
    async function gerarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: "portrait", unit: "mm", format: "a4" });

      const img = new Image();
      img.src = "logo-rotam.png";
      await img.decode();

      doc.addImage(img, "PNG", 90, 10, 30, 30);
      doc.setFontSize(12);
      doc.text("POL√çCIA MILITAR DO ESTADO DE MATO GROSSO", 105, 50, { align: "center" });
      doc.text("Comando de Policiamento Especializado", 105, 56, { align: "center" });
      doc.text("Batalh√£o ROTAM", 105, 62, { align: "center" });
      doc.text(`Relat√≥rio de Servi√ßo do Dia: ${dataFormatada}`, 105, 68, { align: "center" });

      let y = 80;
      const campos = [
        ["1Ô∏è‚É£ ROTAM Comando e ROTAM 90:", document.getElementById("rotamComando").value],
        ["2Ô∏è‚É£ Altera√ß√µes na Escala de Servi√ßo:", document.getElementById("alteracoesEscala").value],
        ["3Ô∏è‚É£ Distribui√ß√£o das Equipes:", document.getElementById("distribuicaoEquipes").value],
        ["4Ô∏è‚É£ Ocorr√™ncias Registradas:", document.getElementById("ocorrencias").value],
        ["5Ô∏è‚É£ Justi√ßa e Disciplina:", document.getElementById("justicaDisciplina").value],
        ["6Ô∏è‚É£ Documentos:", document.getElementById("documentos").value],
        ["7Ô∏è‚É£ Diversos:", document.getElementById("diversos").value]
      ];

      campos.forEach(([titulo, texto]) => {
        doc.setFont("helvetica", "bold");
        doc.text(titulo, 10, y);
        doc.setFont("helvetica", "normal");
        y += 6;
        const linhas = doc.splitTextToSize(texto || "‚Äî", 190);
        doc.text(linhas, 10, y);
        y += linhas.length * 6 + 4;
      });

      doc.text("Quartel do Batalh√£o ROTAM ‚Äî Cuiab√°/MT", 105, 285, { align: "center" });
      doc.text(`Data: ${dataFormatada}`, 105, 291, { align: "center" });

      doc.save(`Livro_RT90_${dataFormatada}.pdf`);
    }
  </script>
</body>
</html>
